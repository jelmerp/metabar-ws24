<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jelmer Poelstra">
<meta name="dcterms.date" content="2024-03-13">

<title>OSC Intro</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Metabarcoding Workshop</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text"><i class="fa-solid fa-home" aria-label="home"></i></span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-wed" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Wed</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-wed">    
        <li class="dropdown-header">Intro to Metabarcoding</li>
        <li>
    <a class="dropdown-item" href="./02_osc.html">
 <span class="dropdown-text">Intro to OSC</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./03_qc-trim.html">
 <span class="dropdown-text">QC &amp; Trimmming</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-thu" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Thu</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-thu">    
        <li class="dropdown-header">ASV/OTU calling and pipeline considerations</li>
        <li class="dropdown-header">Calling ASVs with DADA2</li>
        <li class="dropdown-header">Alpha &amp; Beta Diversity</li>
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-fri" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Fri</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-fri">    
        <li class="dropdown-header">Network Analysis</li>
        <li class="dropdown-header">Core Microbiome Analysis</li>
        <li class="dropdown-header">Metada &amp; Data Submission</li>
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-homework" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Homework</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-homework">    
        <li>
    <a class="dropdown-item" href="./homework/instructions.html">
 <span class="dropdown-text">Instructions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./homework/shell.html">
 <span class="dropdown-text">Unix Shell</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./homework/R.html">
 <span class="dropdown-text">R</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/jelmerp/metabar-ws24">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools-item" href="https://github.com/jelmerp/metabar-ws24/issues/new">
            Report an Issue
            </a>
          </li>
      </ul>
    </div>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#a-computational-infrastructure-for-genomics" id="toc-a-computational-infrastructure-for-genomics" class="nav-link active" data-scroll-target="#a-computational-infrastructure-for-genomics"><span class="header-section-number">1</span> A computational infrastructure for genomics</a></li>
  <li><a href="#high-performance-computing" id="toc-high-performance-computing" class="nav-link" data-scroll-target="#high-performance-computing"><span class="header-section-number">2</span> High-performance computing</a></li>
  <li><a href="#the-structure-of-a-supercomputer-center" id="toc-the-structure-of-a-supercomputer-center" class="nav-link" data-scroll-target="#the-structure-of-a-supercomputer-center"><span class="header-section-number">3</span> The structure of a supercomputer center</a>
  <ul class="collapse">
  <li><a href="#terminology" id="toc-terminology" class="nav-link" data-scroll-target="#terminology"><span class="header-section-number">3.1</span> Terminology</a></li>
  <li><a href="#supercomputer-components" id="toc-supercomputer-components" class="nav-link" data-scroll-target="#supercomputer-components"><span class="header-section-number">3.2</span> Supercomputer components</a></li>
  </ul></li>
  <li><a href="#osc-ondemand" id="toc-osc-ondemand" class="nav-link" data-scroll-target="#osc-ondemand"><span class="header-section-number">4</span> OSC OnDemand</a>
  <ul class="collapse">
  <li><a href="#files-file-system-access" id="toc-files-file-system-access" class="nav-link" data-scroll-target="#files-file-system-access"><span class="header-section-number">4.1</span> Files: File system access</a></li>
  <li><a href="#clusters-unix-shell-access" id="toc-clusters-unix-shell-access" class="nav-link" data-scroll-target="#clusters-unix-shell-access"><span class="header-section-number">4.2</span> Clusters: Unix shell access</a></li>
  <li><a href="#interactive-apps" id="toc-interactive-apps" class="nav-link" data-scroll-target="#interactive-apps"><span class="header-section-number">4.3</span> Interactive Apps</a></li>
  </ul></li>
  <li><a href="#vs-code" id="toc-vs-code" class="nav-link" data-scroll-target="#vs-code"><span class="header-section-number">5</span> VS Code</a>
  <ul class="collapse">
  <li><a href="#what-is-vs-code" id="toc-what-is-vs-code" class="nav-link" data-scroll-target="#what-is-vs-code"><span class="header-section-number">5.1</span> What is VS Code?</a></li>
  <li><a href="#the-vs-code-user-interface" id="toc-the-vs-code-user-interface" class="nav-link" data-scroll-target="#the-vs-code-user-interface"><span class="header-section-number">5.2</span> The VS Code User Interface</a></li>
  <li><a href="#a-folder-as-a-starting-point" id="toc-a-folder-as-a-starting-point" class="nav-link" data-scroll-target="#a-folder-as-a-starting-point"><span class="header-section-number">5.3</span> A folder as a starting point</a></li>
  </ul></li>
  <li><a href="#further-reading" id="toc-further-reading" class="nav-link" data-scroll-target="#further-reading">Further reading</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Intro to the Ohio Supercomputer Center (OSC)</h1>
<p class="subtitle lead">And the VS Code text editor</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jelmer Poelstra </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 13, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<hr>
<hr style="height:1pt; visibility:hidden;">
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
THIS PAGE IS STILL UNDER CONSTRUCTION
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<p><br></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/osc_logo.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
<p><br></p>
<section id="a-computational-infrastructure-for-genomics" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="a-computational-infrastructure-for-genomics"><span class="header-section-number">1</span> A computational infrastructure for genomics</h2>
<p>Due in large part to the amount of data involved, a laptop or desktop computer is often not sufficient to work with large-scale genomics data. Additionally, many of the specialized programs that help you analyze your data can only be run through a “command-line interface”.</p>
<p>Those are some of the reasons that a typical computational infrastructure to do what we may call “command-line genomics” involves the following components:</p>
<ol type="1">
<li>A <strong>supercomputer</strong> — in our case, the Ohio Supercomputer Center (OSC) <em>[this session]</em></li>
<li>A <strong>text editor</strong> — I recommend and will demonstrate VS Code <em>[this session]</em></li>
<li>The <strong>Unix shell</strong> (terminal) <em>[<a href="./homework/shell.html">homework</a> and <a href="./03_qc-trim.html">next session</a>]</em></li>
<li><strong>R</strong><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> for interactive statistical analysis and visualization <em>[<a href="./homework/R.html">homework</a> and Thu + Fri]</em></li>
</ol>
<p>We will be using all of these components during this workshop. <strong>This session</strong> will provide an introduction to supercomputers in general and to the Ohio Supercomputer Center (OSC) specifically. In all of the lab sessions at this workshop, we’ll continue to work at OSC, so you will get a fair bit of experience with working at a supercomputer.</p>
<hr style="height:1pt; visibility:hidden;">
</section>
<section id="high-performance-computing" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="high-performance-computing"><span class="header-section-number">2</span> High-performance computing</h2>
<p>A <strong>supercomputer</strong> (also known as a “compute cluster” or simply a “<strong>cluster</strong>”) consists of many computers that are connected by a high-speed network, and that can be accessed remotely by its users. In more general terms, supercomputers provide high-performance computing (<strong>HPC</strong>) resources.</p>
<p>This is what Owens, one of the OSC supercomputers, physically looks like:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/owens.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></p>
</figure>
</div>
<p>Here are some possible reasons to use a supercomputer instead of your own laptop or desktop:</p>
<ul>
<li>Your analyses take a long time to run, need large numbers of CPUs, or a large amount of memory.</li>
<li>You need to run some analyses many times.</li>
<li>You need to store a lot of data.</li>
<li>Your analyses require specialized hardware, such as GPUs (Graphical Processing Units).</li>
<li>Your analyses require software available only for the Linux operating system, but you use Windows.</li>
</ul>
<p>When you’re working with genomics data, many of these reasons typically apply. This can make it hard or sometimes simply impossible to do all your work on your personal workstation, and supercomputers provide a solution.</p>
<hr style="height:1pt; visibility:hidden;">
<section id="the-ohio-supercomputer-center-osc" class="level4">
<h4 class="anchored" data-anchor-id="the-ohio-supercomputer-center-osc">The Ohio Supercomputer Center (OSC)</h4>
<p>The Ohio Supercomputer Center (OSC) is a facility provided by the state of Ohio in the US. It has two supercomputers, lots of storage space, and an excellent infrastructure for accessing these resources.</p>
<hr style="height:1pt; visibility:hidden;">
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
OSC websites and “Projects”
</div>
</div>
<div class="callout-body-container callout-body">
<p>OSC has <strong>three main websites</strong> — we will mostly or only use the first:</p>
<ul>
<li><a href="https://ondemand.osc.edu" class="uri"><strong>https://ondemand.osc.edu</strong></a>: A web portal to use OSC resources through your browser (<em>login needed</em>).</li>
<li><a href="https://my.osc.edu" class="uri">https://my.osc.edu</a>: Account and project management (<em>login needed</em>).</li>
<li><a href="https://osc.edu" class="uri">https://osc.edu</a>: General website with information about the supercomputers, installed software, and usage.</li>
</ul>
<hr>
<p>Access to OSC’s computing power and storage space goes through <strong>OSC “Projects”</strong>:</p>
<ul>
<li>A project can be tied to a research project or lab, or be educational like this course’s project, <code>PAS2714</code>.</li>
<li>Each project has a budget in terms of “compute hours” and storage space<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>.</li>
<li>As a user, it’s possible to be a member of multiple different projects.</li>
</ul>
</div>
</div>
<hr style="height:1pt; visibility:hidden;">
</section>
</section>
<section id="the-structure-of-a-supercomputer-center" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="the-structure-of-a-supercomputer-center"><span class="header-section-number">3</span> The structure of a supercomputer center</h2>
<section id="terminology" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="terminology"><span class="header-section-number">3.1</span> Terminology</h3>
<p>Let’s start with some (super)computing terminology, going from smaller things to bigger things:</p>
<ul>
<li><strong>Core / Processor / CPU / Thread</strong><br>
Components of a computer (node) that can each (semi-)indendepently be asked to perform a computing task like running a bioinformatics program. For our purposes, we can treat these terms as synonyms.</li>
<li><strong>Node</strong><br>
A single computer that is a part of a supercomputer.</li>
<li><strong>Supercomputer / Cluster</strong><br>
A collection of computers connected by a high-speed network. OSC has two: “Pitzer” and “Owens”.</li>
<li><strong>Supercomputer Center</strong><br>
A facility like OSC that has one or more supercomputers.</li>
</ul>
</section>
<section id="supercomputer-components" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="supercomputer-components"><span class="header-section-number">3.2</span> Supercomputer components</h3>
<p>We can think of a supercomputer as having three main parts:</p>
<ul>
<li><strong>File Systems</strong>: Where files are stored (these are shared between the two OSC supercomputers!)</li>
<li><strong>Login Nodes</strong>: The handful of computers everyone shares after logging in</li>
<li><strong>Compute Nodes</strong>: The many computers you can reserve to run your analyses</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/cluster_overview_ed.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
<hr style="height:1pt; visibility:hidden;">
<section id="file-systems" class="level4">
<h4 class="anchored" data-anchor-id="file-systems">File systems</h4>
<p>OSC has several distinct file systems:</p>
<table class="table">
<colgroup>
<col style="width: 16%">
<col style="width: 20%">
<col style="width: 25%">
<col style="width: 15%">
<col style="width: 21%">
</colgroup>
<thead>
<tr class="header">
<th>File system</th>
<th>Located within</th>
<th>Quota</th>
<th>Backed up?</th>
<th>One for each…</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Home</strong></td>
<td><code>/users/</code></td>
<td>500 GB / 1 M files</td>
<td>Yes</td>
<td>User</td>
</tr>
<tr class="even">
<td><strong>Project</strong></td>
<td><code>/fs/ess/</code></td>
<td>Flexible</td>
<td>Yes</td>
<td>OSC Project</td>
</tr>
<tr class="odd">
<td><strong>Scratch</strong></td>
<td><code>/fs/scratch/</code></td>
<td>100 TB</td>
<td>No</td>
<td>OSC Project</td>
</tr>
</tbody>
</table>
<p>During the course, we will be working in the project directory of the course’s OSC Project <code>PAS2714</code>: <code>/fs/ess/PAS2714</code>. (We’ll talk more about these different file systems in week 5.)</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Directory is just another word for folder, often written as “dir” for short
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<hr style="height:1pt; visibility:hidden;">
</section>
<section id="login-nodes" class="level4">
<h4 class="anchored" data-anchor-id="login-nodes">Login Nodes</h4>
<p>Login nodes are set aside as an initial landing spot for everyone who logs in to a supercomputer. There are only a handful of them on each supercomputer, they are shared among everyone, and cannot be “reserved”.</p>
<p>As such, login nodes are meant only to do things like organizing your files and creating scripts for compute jobs, and are <strong><em>not</em></strong> <strong>meant for any serious computing</strong>, which should be done on the compute nodes.</p>
<hr style="height:1pt; visibility:hidden;">
</section>
<section id="compute-nodes" class="level4">
<h4 class="anchored" data-anchor-id="compute-nodes">Compute Nodes</h4>
<p>Data processing and analysis is done on compute nodes. You can only use compute nodes after putting in a <strong>request</strong> for resources (a “job”). The Slurm <em>job scheduler</em>, which we will learn to use in week 5, will then assign resources to your request.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Compute node types
</div>
</div>
<div class="callout-body-container callout-body">
<p>Compute nodes come in different shapes and sizes. Standard, default nodes work fine for the vast majority of analyses, even with large-scale omics data. But you will sometimes need non-standard nodes, such as when you need a lot of RAM memory or need GPUs<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>.</p>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
At-home reading: What works differently on a supercomputer like at OSC? <em>(Click to expand)</em>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Compared to command-line computing on a laptop or desktop, a number of aspects are different when working on a supercomputer like at OSC. We’ll learn much more about these later on in the course, but here is an overview:</p>
<ul>
<li><strong>“Non-interactive” computing is common</strong><br>
It is common to write and “submit” scripts to a queue instead of running programs interactively.</li>
<li><strong>Software</strong><br>
You generally can’t install “the regular way”, and a lot of installed software needs to be “loaded”.</li>
<li><strong>Operating system</strong><br>
Supercomputers run on the Linux operating system.</li>
<li><strong>Login versus compute nodes</strong><br>
As mentioned, the nodes you end up on after logging in are not meant for heavy computing and you have to <em>request access to “compute nodes”</em> to run most analyses.<br>
</li>
</ul>
</div>
</div>
</div>
<hr style="height:1pt; visibility:hidden;">
</section>
</section>
</section>
<section id="osc-ondemand" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="osc-ondemand"><span class="header-section-number">4</span> OSC OnDemand</h2>
<p>The OSC OnDemand web portal allows you to use a web browser to access OSC resources such as:</p>
<ul>
<li>A <strong>file browser</strong> where you can also create and rename folders and files, etc.</li>
<li>A <strong>Unix shell</strong></li>
<li>“<strong>Interactive Apps</strong>”: programs such as RStudio, Jupyter, VS Code and QGIS.</li>
</ul>
<p><i class="fa-solid fa-user-edit" aria-label="user-edit"></i> <strong>Go to <a href="https://ondemand.osc.edu" class="uri">https://ondemand.osc.edu</a> and log in</strong> (use the boxes on the left-hand side)</p>
<p>You should see a landing page similar to the one below:</p>
<p align="center">
</p><p><img src="img/ondemand_home.png" width="90%"></p>
<p></p>
<p>We will now go through some of the dropdown menus in the <strong>blue bar along the top</strong>.</p>
<hr style="height:1pt; visibility:hidden;">
<section id="files-file-system-access" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="files-file-system-access"><span class="header-section-number">4.1</span> Files: File system access</h3>
<p>Hovering over the <strong>Files</strong> dropdown menu gives a list of directories that you have access to. If your account is brand new, and you were added to <code>PAS2714</code>, you should only have three directories listed:</p>
<ol type="1">
<li>A <strong>Home</strong> directory (starts with <code>/users/</code>)</li>
<li>The <code>PAS2714</code> project’s “<strong>scratch</strong>” directory (<code>/fs/scratch/PAS2714</code>)</li>
<li>The <code>PAS2714</code> project’s “<strong>project</strong>” directory (<code>/fs/ess/PAS2714</code>)</li>
</ol>
<p>You will only ever have one Home directory at OSC, but for every additional project you are a member of, you should usually see additional <code>/fs/ess</code> and <code>/fs/scratch</code> directories appear.</p>
<p><i class="fa-solid fa-user-edit" aria-label="user-edit"></i> <strong>In the Files dropdown menu, click on our focal directory <code>/fs/ess/PAS2714</code></strong>.</p>
<p>Once there, you should see whichever directories and files are present at the selected location, and you can click on the directories to explore the contents further:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/ondemand_files_pas2714.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:95.0%"></p>
</figure>
</div>
<p>This interface is <strong>much like the file browser on your own computer</strong>, so you can also create, delete, move and copy files and folders, and even upload (from your computer to OSC) and download (from OSC your computer) files<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> — see the buttons across the top.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Didn’t create your own dir in the Unix shell homework? Click here and follow these instructions to do it now.
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>Click on the <code>users</code> dir in <code>/fs/ess/PAS714</code>.</li>
<li>Create your own dir by clicking the <code>New Directory</code> button towards the top.</li>
<li>Please give it the <strong>exact same name as your OSC username</strong> (also match the capitalization!).</li>
</ul>
<p><em>(If you’re not sure what your username is — look at the right side of the blue top bar, “Logged in as”:)</em></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/username.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:40.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<hr style="height:1pt; visibility:hidden;">
</section>
<section id="clusters-unix-shell-access" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="clusters-unix-shell-access"><span class="header-section-number">4.2</span> Clusters: Unix shell access</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
System Status within Clusters <em>(Click to expand)</em>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In the “<strong>Clusters</strong>” dropdown menu, click on the item at the bottom, “<strong>System Status</strong>”:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/ondemand_systemstatus_select.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></p>
</figure>
</div>
<p>This page shows an overview of the live, current usage of the two clusters — that can be interesting to get a good idea of the scale of the supercomputer center, which cluster is being used more, what the size of the “queue” (which has jobs waiting to start) is, and so on.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/ondemand_systemstatus.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<p>Interacting with a supercomputer is most commonly done using a Unix shell. Under the <strong>Clusters</strong> dropdown menu, you can access a Unix shell either on Owens or Pitzer:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/ondemand_shell_select.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></p>
</figure>
</div>
<p>I’m selecting a shell on the Pitzer supercomputer (“Pitzer Shell Access”), which will open a new browser tab, where the bottom of the page looks like this:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/ondemand_shell2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:95.0%"></p>
</figure>
</div>
<p>However, from now on, we’ll be accessing a Unix shell <strong>inside the VS Code text editor</strong>, which also gives us some additional functionality in a user-friendly way.</p>
<hr style="height:1pt; visibility:hidden;">
</section>
<section id="interactive-apps" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="interactive-apps"><span class="header-section-number">4.3</span> Interactive Apps</h3>
<p>We can access programs with Graphical User Interfaces (<strong>GUI</strong>s; point-and-click interfaces) via the <strong>Interactive Apps</strong> dropdown menu — let’s select VS Code using the “Code Server” button:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/ondemand_vscode_select.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:32.0%"></p>
</figure>
</div>
<p>Interactive Apps like VS Code and RStudio <strong>run on compute nodes</strong> (not login nodes). Because compute nodes always need to be “reserved”, we have to fill out a form and specify the following details:</p>
<table class="table">
<colgroup>
<col style="width: 59%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th>Option</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>The OSC <code>Project</code> to be billed for the compute resource usage</td>
<td><code>PAS2714</code></td>
</tr>
<tr class="even">
<td>The <code>Number of hours</code> we want to make a reservation for<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></td>
<td><code>3</code></td>
</tr>
<tr class="odd">
<td>The <code>Working Directory</code><a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> for the program</td>
<td>Your personal folder in <code>/fs/ess/PAS2714</code> (e.g.&nbsp;<code>/fs/ess/PAS2714/jelmer</code>)</td>
</tr>
<tr class="even">
<td>The <code>Codeserver Version</code></td>
<td><code>4.8</code></td>
</tr>
</tbody>
</table>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/ondemand_vscode_form2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></p>
</figure>
</div>
<p>Click on <strong>Launch</strong> at the bottom, which will send your request to the “compute job” scheduler.</p>
<p>First, your job will be “<em>Queued</em>” — that is, waiting for the job scheduler to allocate compute node resources to it:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/ondemand_vscode_queued.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:75.0%"></p>
</figure>
</div>
<p>Your job is typically granted resources within a few seconds (the card will then say “<em>Starting</em>”), and should be ready for usage (“<em>Running</em>”) in another couple of seconds:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/ondemand_vscode_running.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:75.0%"></p>
</figure>
</div>
<p>Once it appears, click on the blue <strong>Connect to VS Code</strong> button to open VS Code in a new browser tab.</p>
<p>When VS Code opens, you may get these two pop-ups (and possibly some others) — click “Yes” (and check the box) and “Don’t Show Again”, respectively:</p>
<div class="columns">
<div class="column" style="width:52%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/vscode-trust2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div><div class="column" style="width:48%;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/vscode-git.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p><br></p>
</section>
</section>
<section id="vs-code" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="vs-code"><span class="header-section-number">5</span> VS Code</h2>
<section id="what-is-vs-code" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="what-is-vs-code"><span class="header-section-number">5.1</span> What is VS Code?</h3>
<p>VS Code is basically a <strong>fancy text editor</strong>. Its full name is Visual Studio Code, but at OSC, it is also referred to as “Code Server”.</p>
<p>To emphasize the additional functionality relative to basic text editors like Notepad and TextEdit, editors like VS Code are also referred to as “<strong>IDEs</strong>”: <em>Integrated Development Environments</em>. The RStudio program is another good example of an IDE. For our purposes:</p>
<ul>
<li>VS code will be our IDE for Unix shell code</li>
<li>RStudio will be our IDE for R</li>
</ul>
<hr style="height:1pt; visibility:hidden;">
</section>
<section id="the-vs-code-user-interface" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="the-vs-code-user-interface"><span class="header-section-number">5.2</span> The VS Code User Interface</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/vscode-welcome_ed.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
<section id="side-bars" class="level4">
<h4 class="anchored" data-anchor-id="side-bars">Side bars</h4>
<p>The <strong>Activity Bar</strong> (narrow side bar) on the far left has:</p>
<ul>
<li>A <i class="fa-solid fa-bars" aria-label="bars"></i> (“hamburger menu”), which has menu items like <code>File</code> that you often find in a top bar.</li>
<li>A <i class="fa-solid fa-cog" aria-label="cog"></i> (cog wheel icon) in the bottom, through which you can mainly access <em>settings</em>.</li>
<li>Icons to toggle <strong>(wide) Side Bar</strong> options — but we’ll only use the default selection, the <em>Explorer</em> (file browser)</li>
</ul>
</section>
<section id="editor-pane-and-welcome-document" class="level4">
<h4 class="anchored" data-anchor-id="editor-pane-and-welcome-document">Editor pane and <code>Welcome</code> document</h4>
<p>The main part of the VS Code is the <strong>editor pane</strong>. Here, we can open files like scripts and other types of text files, and images. (Whenever you open VS Code, an editor tab with a <code>Welcome</code> document is automatically opened. This provides some help and some shortcuts like to recently opened files and folders.)</p>
</section>
<section id="terminal-with-a-unix-shell" class="level4">
<h4 class="anchored" data-anchor-id="terminal-with-a-unix-shell">Terminal (with a Unix shell)</h4>
<p><i class="fa-solid fa-user-edit" aria-label="user-edit"></i> <strong>Open a terminal</strong> by clicking &nbsp; <i class="fa-solid fa-bars" aria-label="bars"></i> &nbsp; =&gt; <code>Terminal</code> =&gt; <code>New Terminal</code>.</p>
<hr style="height:1pt; visibility:hidden;">
</section>
<section id="exercise-try-a-few-color-themes" class="level4 exercise">
<h4 class="anchored" data-anchor-id="exercise-try-a-few-color-themes"><i class="fa-solid fa-user-edit" aria-label="user-edit"></i> Exercise: Try a few color themes</h4>
<ol type="1">
<li>Access the “Color Themes” option by clicking <i class="fa fa-cog"></i> =&gt; <code>Color Theme</code>.</li>
<li>Try out a few themes and see pick one you like!</li>
</ol>
</section>
<hr style="height:1pt; visibility:hidden;">
</section>
<section id="a-folder-as-a-starting-point" class="level3" data-number="5.3">
<h3 data-number="5.3" class="anchored" data-anchor-id="a-folder-as-a-starting-point"><span class="header-section-number">5.3</span> A folder as a starting point</h3>
<p>Conveniently, VS Code takes a specific directory as a <strong>starting point in all parts of the program</strong>:</p>
<ul>
<li>In the file explorer in the side bar</li>
<li>In the terminal</li>
<li>When saving files in the editor pane.</li>
</ul>
<p><em>(If you need to switch folders, click &nbsp; <i class="fa-solid fa-bars" aria-label="bars"></i> &nbsp; =&gt; &nbsp; <code>File</code> &nbsp; =&gt; &nbsp; <code>Open Folder</code>.)</em></p>
<hr style="height:1pt; visibility:hidden;">
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Some VS Code tips and tricks
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><p><strong>Resizing panes</strong><br>
You can resize panes (the terminal, editor, and side bar) by hovering your cursor over the borders and then dragging.</p></li>
<li><p><strong>The Command Palette</strong><br>
To access all the menu options that are available in VS Code, the so-called “Command Palette” can be handy, especially if you know what you are looking for. To access the Command Palette, click &nbsp; <i class="fa fa-cog"></i> &nbsp; and then <code>Command Palette</code> (or press <kbd>F1</kbd> or <kbd>Ctrl</kbd>/<kbd>⌘</kbd>+<kbd>Shift</kbd>+<kbd>P</kbd>).</p></li>
<li><p><strong>Keyboard shortcuts</strong><br>
For a single-page PDF overview of keyboard shortcuts for your operating system: &nbsp; <i class="fa-solid fa-bars" aria-label="bars"></i> &nbsp; =&gt; &nbsp; <code>Help</code> &nbsp; =&gt; &nbsp; <code>Keyboard Shortcut Reference</code>. (Or for direct links to these PDFs: <a href="https://code.visualstudio.com/shortcuts/keyboard-shortcuts-windows.pdf">Windows</a> / <a href="https://code.visualstudio.com/shortcuts/keyboard-shortcuts-macos.pdf">Mac</a> / <a href="https://code.visualstudio.com/shortcuts/keyboard-shortcuts-linux.pdf">Linux</a>.) A couple of useful keyboard shortcuts are highlighted below.</p></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Specific useful keyboard shortcuts <em>(Click to expand)</em>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Working with keyboard shortcuts for common operations can be a lot faster than using your mouse. Below are some useful ones for VS Code (for Mac, in some case, you’ll have to replace <kbd>Ctrl</kbd> with <kbd>⌘</kbd>):</p>
<ul>
<li><p><em>Open a terminal</em>: <kbd>Ctrl</kbd>+<kbd>`</kbd> (backtick) or <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>C</kbd>.</p></li>
<li><p><em>Toggle between the terminal and the editor pane</em>: <kbd>Ctrl</kbd>+<kbd>`</kbd> and <kbd>Ctrl</kbd>+<kbd>1</kbd>.</p></li>
<li><p><em>Toggle the (wide) Side Bar</em>: <kbd>Ctrl</kbd>+<kbd>B</kbd></p></li>
<li><p><em>Line actions</em>:</p>
<ul>
<li><p><kbd>Ctrl</kbd>+<kbd>X</kbd> / <kbd>C</kbd> will <strong>cut/copy the entire line</strong> where the cursor is, when nothing is selected (!)</p></li>
<li><p><kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>K</kbd> will <strong>delete a line</strong></p></li>
<li><p><kbd>Alt</kbd>+<kbd>⬆</kbd>/<kbd>⬇</kbd> will <strong>move lines</strong> up or down.</p></li>
</ul></li>
</ul>
</div>
</div>
</div>
<p><br></p>
</section>
</section>
<section id="further-reading" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="further-reading">Further reading</h2>
<section id="oscs-learning-resources" class="level4">
<h4 class="anchored" data-anchor-id="oscs-learning-resources">OSC’s learning resources</h4>
<ul>
<li><a href="https://mcic-osu.github.io/rnaseq-intro/modules/A01_osc.html">An extended version of this introduction</a></li>
<li><a href="https://www.osc.edu/supercomputing/training">OSC’s online asynchronous courses</a></li>
<li><a href="https://www.osc.edu/resources/getting_started/new_user_resource_guide">OSC’s new User Resource Guide</a><a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></li>
</ul>


</section>
</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Or Python<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>But we don’t have to pay anything for educational projects like this one. Otherwise, for OSC’s rates for academic research, see <a href="https://www.osc.edu/content/academic_fee_model_faq">this page</a>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>GPUs are e.g.&nbsp;used for Nanopore basecalling<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Though this is not meant for large (&gt;1 GB) transfers. Different methods are available — we’ll talk about those later on.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Note that we’ll be kicked off as soon as that amount of time has passed!<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>This will be your starting location in the file system; we’ll talk more about working dirs in a little bit.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p> Attribution: This page uses material from an <a href="https://mcic-osu.github.io/cl-workshop-22/modules/02-osc.html">OSC Introduction written by Mike Sovic</a> and from OSC’s Kate Cahill <a href="https://khill42.github.io/OSC_IntroHPC%3E">Software Carpentry introduction to OSC</a>.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>